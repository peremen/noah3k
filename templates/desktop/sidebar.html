<% from web import ctx
from i18n import custom_gettext as _
import user, board
from datetime import datetime
def get_friend_boards(type):
    friend_list = []

    for b in board.search_board('%%[%s%%' % type):
    	friend_list.append(dict(year = b.bDescription[3:5], board = b))

    return friend_list
%>
% if ctx.session.has_key('uid'):
<div class="heading"><a class="plainlink" href="/+u/${ctx.session.username}/+my_board">${_('My Boards')}</a>
    <div style="float: right;">
        <span style="color: black; font-size: 0.9em; font-weight: normal;">
            <a class="plainlink" href="#" id="fold_my_boards" onclick="$('#my_boards').toggle();">${_('(toggle)')}</a>
        </span>
    </div>
</div>
<div id="my_boards" style="display: inline;">
<ul>
<% not_has_my_board = True %>
% for my_board in user.get_owned_board(ctx.session.uid):
    <li><a class="boardlink" href="${my_board.bName}">\
    % if my_board.bType == 0:
<img class="type" src="/static/image/folder.png" /> \
    % else:
<img class="type" src="/static/image/board.png" /> \
    % endif
    % if my_board.bDescription.strip() == '':
${my_board.bName}\
    % else:
${my_board.bDescription}\
    % endif
</a></li>
    <% not_has_my_board = False %>
% else:
    % if not_has_my_board:
    <li>${_('You have no boards')}</li>
    % endif
% endfor
</ul>
</div>
<br />

<div class="heading"><a class="plainlink" href="/+u/${ctx.session.username}/+favorites">${_('Favorites')}</a> <span style="color: black; font-size:0.9em; font-weight: normal;"><a class="favlink"\
% if board_path is not UNDEFINED:
    % if board_path == '':
    href="#">${_('(not available)')}\
    % elif user.is_favorite(ctx.session.uid, board._get_board_id_from_path(board_path)):
    href="/${board_path}/+remove_from_favorites">${_('(remove)')}\
    % else:
    href="/${board_path}/+add_to_favorites">${_('(add)')}\
    % endif
% else:
href="#">${_('(not available)')}\
% endif
</a></span>
    <div style="float: right;">
        <span style="color: black; font-size: 0.9em; font-weight: normal;">
            <a style="color: black; text-decoration: none;" href="#" id="fold_favorites" onclick="$('#favorites').toggle();">${_('(toggle)')}</a>
        </span>
    </div>
</div>
<div id="favorites" style="display: inline;">
<ul>
<% not_has_fav_board = True %>
% for my_board in user.get_favorite_board_with_detail(ctx.session.uid):
    <li><a class="boardlink" href="${my_board.bName}">\
    % if my_board.bType == 0:
<img class="type" src="/static/image/folder.png" /> \
    % else:
<img class="type" src="/static/image/board.png" /> \
    % endif
    % if my_board.bDescription.strip() == '':
${my_board.bName}\
    % else:
${my_board.bDescription}\
    % endif
</a></li>
    <% not_has_fav_board = False %>
% else:
    % if not_has_fav_board:
    <li>${_('No board in your favorites')}</li>
    % else:
    <li><img src="/static/image/feed.png" /> ${_('Feed')}: <a href="/+u/${ctx.session.username}/+favorite_rss">RSS</a>, <a href="/+u/${ctx.session.username}/+favorite_atom">Atom</a></li>
    % endif
% endfor
</ul>
</div>
<br />
% endif

<div class="heading"><a class="dirlink" href="/divisionCS"><span style="color: black">${_('Department')}</span></a></div>
<ul>
    <li>
        <a class="boardlink" href="/divisionCS/Notice">${_('Notice')}</a> / 
        <a class="boardlink" href="/divisionCS/studentNotice">${_('Student Notice')}</a> / 
        <a class="boardlink" href="/divisionCS/HowAbout">${_('To Dept.')}</a> / 
        <a class="boardlink" href="/divisionCS/EastOfEden">${_('EVE Room')}</a>
    </li>
    <li>
        <a class="boardlink" href="/divisionCS/JobOffer">${_('Job Offer')}</a> / 
        <a class="boardlink" href="/divisionCS/sportsCS">${_('Sports')}</a> / 
        <a class="boardlink" href="/divisionCS/entrExamLabAsgn">${_('Lab Assignment')}</a>
    </li>
</ul>
<br />

<div class="heading"><a class="dirlink" href="/friends"><span style="color: black">${_('Friends')}</span></a></div>
<ul>		
    <li><span style="color: #3C78B5; font-weight: bold">${_('Undg.')}</span>
% for b in get_friend_boards(u'학부'):
<a class="boardlink" href="${b['board'].bName}">'${b['year']}</a> \
% endfor
    </li>
    <li><span style="color: #3C78B5; font-weight: bold">${_('Mast.')}</span>
% for b in get_friend_boards(u'석사'):
<a class="boardlink" href="${b['board'].bName}">'${b['year']}</a> \
% endfor
    </li>
</ul>
<br />

<!-- 과목 게시판 -->
<div id="box">
    <div class="heading">
        <span style="color: black"><a class="dirlink" href="/course"><span style="color: black">${_('Courses')}</span></a></span>
        <span style="color: black; font-size: 0.9em; font-weight: normal"><a href="/OldCourse">${_('(archive)')}</a></span>
    </div>
    <ul>
<% not_has_subject_board = True %>
% for my_board in board.get_child(board._get_board_id_from_path('/course')):
    <li><a class="boardlink" href="${my_board.bName}">\
    % if my_board.bDescription.strip() == '':
${my_board.bName}\
    % else:
${my_board.bDescription}\
    % endif
</a></li>
    <% not_has_subject_board = False %>
% else:
    % if not_has_subject_board:
    <li>${_('No course boards')}</li>
    % endif
% endfor
    </ul>
</div>
<br />
<div class="heading"><a class="dirlink" href="/m"><span style="color: black">${_('NOAH Mobile')}</span></a></div>
<a class="plainlink" href="/m"><img border="0" src="/static/image/qrcode.png" /></a>

%if board_path is not UNDEFINED:
%if feed is not UNDEFINED:
<!-- 피드 (for Google Chrome) -->
<div id="feeds"> 
    <a href="/${board_path}/+rss" class="feed"><img style="border-style: none;" src="/static/image/feed.png" /> RSS</a> 
    <a href="/${board_path}/+atom" class="feed"><img style="border-style: none;" src="/static/image/feed.png" /> Atom</a> 
</div> 
<br />
% endif
% endif
